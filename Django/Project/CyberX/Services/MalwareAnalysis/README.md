# üõ°Ô∏è CyberX Malware Analysis Service

<div align="center">

![Malware Analysis](https://img.shields.io/badge/Malware-Analysis-red?style=for-the-badge&logo=shield)
![Python](https://img.shields.io/badge/Python-3.12-blue?style=for-the-badge&logo=python)
![Django](https://img.shields.io/badge/Django-6.0-green?style=for-the-badge&logo=django)
![Accuracy](https://img.shields.io/badge/Accuracy-100%25-brightgreen?style=for-the-badge)
![License](https://img.shields.io/badge/License-MIT-yellow?style=for-the-badge)

**Advanced malware detection combining signature-based, heuristic, and machine learning methods.**

[Features](#-features) ‚Ä¢ [Architecture](#-architecture) ‚Ä¢ [Installation](#-installation) ‚Ä¢ [Usage](#-usage) ‚Ä¢ [API Reference](#-api-reference)

</div>

---

## üìã Table of Contents

1. [Overview](#-overview)
2. [Features](#-features)
3. [Architecture](#-architecture)
4. [Detection Methods](#-detection-methods)
5. [Installation](#-installation)
6. [Configuration](#-configuration)
7. [Usage](#-usage)
8. [API Reference](#-api-reference)
9. [Machine Learning Models](#-machine-learning-models)
10. [Feature Extraction](#-feature-extraction)
11. [Heuristic Rules](#-heuristic-rules)
12. [Performance](#-performance)
13. [Security Considerations](#-security-considerations)
14. [Troubleshooting](#-troubleshooting)
15. [Contributing](#-contributing)
16. [License](#-license)

---

## üéØ Overview

The CyberX Malware Analysis Service is a production-ready, real-time malware detection system designed for the CyberX cybersecurity platform. It employs a multi-layered defense strategy combining:

- **Signature-based detection** - Known malware hash matching
- **Heuristic analysis** - Behavioral pattern detection with 10+ rules
- **Machine Learning** - Ensemble model with Random Forest & Gradient Boosting

### Key Capabilities

| Capability               | Description                                  |
| ------------------------ | -------------------------------------------- |
| **Real-time Analysis**   | Files analyzed in milliseconds               |
| **Multi-format Support** | PE executables, scripts, documents, archives |
| **Ensemble ML**          | Two models for improved accuracy             |
| **Rich Feature Set**     | 41 extracted features per file               |
| **REST API**             | Easy integration with external systems       |
| **Detailed Reports**     | Comprehensive analysis results               |

---

## ‚ú® Features

### üîê Multi-Layer Detection

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                    FILE UPLOAD                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚îÇ
                            ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ            SIGNATURE DATABASE CHECK                         ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ MD5 Hash Matching                                    ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ SHA1 Hash Matching                                   ‚îÇ
‚îÇ    ‚îî‚îÄ‚îÄ SHA256 Hash Matching                                 ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚îÇ
                            ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ             FEATURE EXTRACTION                              ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ File Metadata (size, type, entropy)                 ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ String Analysis (URLs, IPs, registry)              ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ PE Analysis (imports, sections, signatures)         ‚îÇ
‚îÇ    ‚îî‚îÄ‚îÄ Pattern Detection (suspicious strings)              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚îÇ
                            ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ             HEURISTIC ANALYSIS                              ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ 10 Behavioral Detection Rules                       ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ Severity Scoring (Critical/High/Medium/Low)         ‚îÇ
‚îÇ    ‚îî‚îÄ‚îÄ Threat Level Assessment                             ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚îÇ
                            ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ           MACHINE LEARNING ANALYSIS                         ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ Random Forest (200 trees, 60% weight)               ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ Gradient Boosting (150 estimators, 40% weight)      ‚îÇ
‚îÇ    ‚îî‚îÄ‚îÄ Ensemble Prediction with Confidence                  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            ‚îÇ
                            ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ              FINAL VERDICT                                  ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ Threat Score (0-100)                                ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ Classification (Clean/PUP/Suspicious/Malicious)    ‚îÇ
‚îÇ    ‚îú‚îÄ‚îÄ Detection Methods Used                               ‚îÇ
‚îÇ    ‚îî‚îÄ‚îÄ Actionable Recommendations                           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### üìä Features at a Glance

- ‚úÖ **Signature Database** - Known malware hashes (WannaCry, Petya, etc.)
- ‚úÖ **45+ Suspicious Strings** - Ransomware, keylogger, C2 indicators
- ‚úÖ **30+ Suspicious APIs** - Process injection, persistence, evasion
- ‚úÖ **PE File Analysis** - Sections, imports, signatures
- ‚úÖ **Entropy Calculation** - Packed/encrypted file detection
- ‚úÖ **String Extraction** - URLs, IPs, registry keys
- ‚úÖ **10 Heuristic Rules** - Behavioral pattern detection
- ‚úÖ **Ensemble ML** - 100% accuracy on test data
- ‚úÖ **REST API** - JSON responses for integration
- ‚úÖ **Web Interface** - User-friendly file upload

---

## üèóÔ∏è Architecture

### System Architecture

```
CyberX/
‚îú‚îÄ‚îÄ App/
‚îÇ   ‚îú‚îÄ‚îÄ MalwareAnalysis/           # Django Application
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ apps.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ urls.py                # URL routing
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ views.py               # Main analysis logic
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ migrations/
‚îÇ   ‚îÇ
‚îÇ   ‚îú‚îÄ‚îÄ Frontend/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ templates/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ MalwareAnalysis.html  # Web interface
‚îÇ   ‚îÇ
‚îÇ   ‚îî‚îÄ‚îÄ CyberX/
‚îÇ       ‚îú‚îÄ‚îÄ settings.py            # Django settings
‚îÇ       ‚îî‚îÄ‚îÄ urls.py                # Main URL config
‚îÇ
‚îî‚îÄ‚îÄ Services/
    ‚îî‚îÄ‚îÄ MalwareAnalysis/
        ‚îú‚îÄ‚îÄ model.ipynb            # ML training notebook
        ‚îú‚îÄ‚îÄ README.md              # This documentation
        ‚îî‚îÄ‚îÄ models/                # Trained ML models
            ‚îú‚îÄ‚îÄ malware_rf_model.joblib
            ‚îú‚îÄ‚îÄ malware_gb_model.joblib
            ‚îú‚îÄ‚îÄ malware_scaler.joblib
            ‚îú‚îÄ‚îÄ malware_feature_names.json
            ‚îî‚îÄ‚îÄ model_metadata.json
```

### Component Diagram

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ                     Django Application                       ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ                                                              ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê      ‚îÇ
‚îÇ  ‚îÇ   views.py   ‚îÇ  ‚îÇ   urls.py    ‚îÇ  ‚îÇ  Template    ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ              ‚îÇ  ‚îÇ              ‚îÇ  ‚îÇ  (HTML)      ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ - index()    ‚îÇ  ‚îÇ - /          ‚îÇ  ‚îÇ              ‚îÇ      ‚îÇ
‚îÇ  ‚îÇ - api_analyze‚îÇ  ‚îÇ - /api/      ‚îÇ  ‚îÇ              ‚îÇ      ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò      ‚îÇ
‚îÇ         ‚îÇ                                                    ‚îÇ
‚îÇ         ‚ñº                                                    ‚îÇ
‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê   ‚îÇ
‚îÇ  ‚îÇ               MalwareAnalyzer                         ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                                                       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  Signature  ‚îÇ ‚îÇ   Feature   ‚îÇ ‚îÇ  Heuristic  ‚îÇ    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  Database   ‚îÇ ‚îÇ  Extractor  ‚îÇ ‚îÇ  Analyzer   ‚îÇ    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò    ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ                                                       ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ              ML Models (joblib)                 ‚îÇ  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  - Random Forest      - Gradient Boosting      ‚îÇ  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îÇ  - StandardScaler     - Feature Names          ‚îÇ  ‚îÇ   ‚îÇ
‚îÇ  ‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò  ‚îÇ   ‚îÇ
‚îÇ  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò   ‚îÇ
‚îÇ                                                              ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîç Detection Methods

### 1. Signature-Based Detection

The signature database contains hashes of known malware samples:

```python
KNOWN_MALWARE_HASHES = {
    "ed01ebfbc9eb5bbea545af4d01bf5f1071661840480439c6e5babe8e080e41aa": "WannaCry",
    "24d004a104d4d54034dbcffc2a4b19a11f39008a575aa614ea04703480b1022c": "WannaCry",
    "027cc450ef5f8c5f653329641ec1fed91f694e0d229928963b30f6b0d7d3a745": "Petya",
    # ... more hashes
}
```

**How it works:**

1. Calculate MD5, SHA1, SHA256 hashes of uploaded file
2. Compare against known malware database
3. If match found ‚Üí Immediate "Malicious" verdict

### 2. Heuristic Analysis

10 behavioral detection rules analyze file characteristics:

| Rule ID | Name                    | Severity | Score | Condition                    |
| ------- | ----------------------- | -------- | ----- | ---------------------------- |
| HEUR001 | High Entropy Executable | High     | 30    | PE file with entropy > 7.0   |
| HEUR002 | Suspicious API Imports  | High     | 40    | ‚â•2 high-risk API imports     |
| HEUR003 | Process Injection       | Critical | 50    | ‚â•3 injection-related APIs    |
| HEUR004 | Packed Executable       | Medium   | 25    | UPX/packer sections detected |
| HEUR005 | Network Indicators      | Low      | 10    | URLs or IPs in strings       |
| HEUR006 | Registry Modification   | Medium   | 20    | Registry key references      |
| HEUR007 | Suspicious Strings      | High     | 35    | ‚â•3 malicious string patterns |
| HEUR008 | No Digital Signature    | Low      | 10    | Unsigned PE executable       |
| HEUR009 | PowerShell Encoded      | Critical | 50    | Base64 encoded commands      |
| HEUR010 | Download Capability     | High     | 30    | DownloadString/URLDownload   |

### 3. Machine Learning Analysis

**Ensemble Model Architecture:**

```
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ  41 Features    ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ  StandardScaler ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
              ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
              ‚îÇ                              ‚îÇ
    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê        ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
    ‚îÇ   Random Forest   ‚îÇ        ‚îÇ Gradient Boosting ‚îÇ
    ‚îÇ   (200 trees)     ‚îÇ        ‚îÇ (150 estimators)  ‚îÇ
    ‚îÇ   Weight: 60%     ‚îÇ        ‚îÇ   Weight: 40%     ‚îÇ
    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò        ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
              ‚îÇ                              ‚îÇ
              ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                             ‚îÇ
                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ Ensemble Score  ‚îÇ
                    ‚îÇ (Weighted Avg)  ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## ‚öôÔ∏è Installation

### Prerequisites

- Python 3.10+
- Django 6.0+
- Virtual environment (recommended)

### Step 1: Clone Repository

```bash
git clone https://github.com/yourusername/CyberX.git
cd CyberX
```

### Step 2: Create Virtual Environment

```bash
python -m venv env

# Windows
.\env\Scripts\Activate.ps1

# Linux/Mac
source env/bin/activate
```

### Step 3: Install Dependencies

```bash
pip install -r requirements.txt
```

### Step 4: Install Additional Packages

```bash
pip install pefile scikit-learn numpy pandas joblib
```

### Step 5: Verify Installation

```bash
cd App
python manage.py check
```

Expected output:

```
[INFO] MalwareAnalysis: ‚úÖ ML models loaded successfully
System check identified no issues (0 silenced).
```

### Step 6: Run Server

```bash
python manage.py runserver
```

Access the service at: `http://127.0.0.1:8000/malwareanalysis/`

---

## üîß Configuration

### Django Settings

Add to `INSTALLED_APPS` in `settings.py`:

```python
INSTALLED_APPS = [
    # ... other apps
    'MalwareAnalysis',
]
```

### URL Configuration

Add to `urls.py`:

```python
urlpatterns = [
    # ... other urls
    path('malwareanalysis/', include('MalwareAnalysis.urls')),
]
```

### Model Paths

Models are loaded from:

```
Services/MalwareAnalysis/models/
‚îú‚îÄ‚îÄ malware_rf_model.joblib      # Random Forest model
‚îú‚îÄ‚îÄ malware_gb_model.joblib      # Gradient Boosting model
‚îú‚îÄ‚îÄ malware_scaler.joblib        # Feature scaler
‚îú‚îÄ‚îÄ malware_feature_names.json   # Feature list
‚îî‚îÄ‚îÄ model_metadata.json          # Model info
```

---

## üöÄ Usage

### Web Interface

1. Navigate to `http://localhost:8000/malwareanalysis/`
2. Click "Choose File" to select a file
3. Click "Analyze File"
4. View results:
   - Verdict (Clean/Suspicious/Malicious)
   - Threat Score (0-100)
   - Detection Methods
   - Risk Factors
   - Recommendations

### Command Line (Python)

```python
from MalwareAnalysis.views import MalwareAnalyzer

# Initialize analyzer
analyzer = MalwareAnalyzer()

# Analyze file
with open('suspicious_file.exe', 'rb') as f:
    file_data = f.read()

result = analyzer.analyze_file(file_data, 'suspicious_file.exe')

print(f"Verdict: {result['verdict']}")
print(f"Threat Score: {result['threat_score']}/100")
print(f"Confidence: {result['confidence']}%")
```

### cURL (API)

```bash
curl -X POST \
  -F "file=@suspicious_file.exe" \
  http://localhost:8000/malwareanalysis/api/analyze/
```

---

## üì° API Reference

### Endpoint: `/malwareanalysis/api/analyze/`

**Method:** POST

**Content-Type:** multipart/form-data

**Parameters:**
| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| file | File | Yes | File to analyze (max 50MB) |

**Response:**

```json
{
  "filename": "sample.exe",
  "file_size": 256000,
  "file_size_formatted": "250.00 KB",
  "analysis_time": 45.23,
  "verdict": "suspicious",
  "threat_score": 65,
  "confidence": 85.0,
  "is_malicious": true,
  "detection_methods": ["heuristic", "machine_learning"],
  "signatures": {
    "md5": "d41d8cd98f00b204e9800998ecf8427e",
    "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709",
    "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855"
  },
  "heuristic_analysis": {
    "heuristic_score": 55,
    "threat_level": "high",
    "triggered_rules": [
      {
        "id": "HEUR001",
        "name": "High Entropy Executable",
        "severity": "high",
        "score": 30
      },
      {
        "id": "HEUR004",
        "name": "Packed Executable",
        "severity": "medium",
        "score": 25
      }
    ],
    "rule_count": 2
  },
  "ml_analysis": {
    "rf_prediction": 1,
    "rf_confidence": 87.5,
    "gb_prediction": 1,
    "gb_confidence": 82.3,
    "ensemble_confidence": 85.42,
    "is_malicious": true
  },
  "features": {
    "file_type": "PE Executable",
    "entropy": 7.34,
    "is_packed": true,
    "suspicious_strings": 3,
    "suspicious_imports": 2,
    "url_count": 1,
    "ip_count": 0
  },
  "risk_factors": ["High Entropy Executable", "Packed Executable"],
  "recommendations": [
    "‚ö†Ô∏è Quarantine this file",
    "Submit to VirusTotal",
    "Do not execute"
  ]
}
```

**Error Responses:**

| Status | Description                  |
| ------ | ---------------------------- |
| 400    | No file provided             |
| 400    | File size exceeds 50MB limit |
| 500    | Internal server error        |

---

## ü§ñ Machine Learning Models

### Model Training

The models were trained using the Jupyter notebook at `Services/MalwareAnalysis/model.ipynb`.

**Training Configuration:**

| Parameter         | Random Forest | Gradient Boosting |
| ----------------- | ------------- | ----------------- |
| Estimators        | 200           | 150               |
| Max Depth         | 20            | 10                |
| Min Samples Split | 5             | 10                |
| Learning Rate     | -             | 0.1               |
| Random State      | 42            | 42                |

### Training Data

- **Total Samples:** 10,000
- **Benign:** 5,000 (50%)
- **Malicious:** 5,000 (50%)
- **Features:** 41

### Model Performance

```
‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
‚ïë                   MODEL PERFORMANCE METRICS                  ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë  Model              ‚îÇ Accuracy ‚îÇ Precision ‚îÇ Recall ‚îÇ F1    ‚ïë
‚ï†‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï™‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï™‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï™‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï™‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ï£
‚ïë  Random Forest      ‚îÇ  100.0%  ‚îÇ   100.0%  ‚îÇ 100.0% ‚îÇ 1.00  ‚ïë
‚ïë  Gradient Boosting  ‚îÇ  100.0%  ‚îÇ   100.0%  ‚îÇ 100.0% ‚îÇ 1.00  ‚ïë
‚ïë  Ensemble           ‚îÇ  100.0%  ‚îÇ   100.0%  ‚îÇ 100.0% ‚îÇ 1.00  ‚ïë
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù
```

### Retraining Models

```python
# In Services/MalwareAnalysis/model.ipynb

# 1. Load your dataset
# 2. Run all cells to train
# 3. Models saved automatically to ./models/
```

---

## üìà Feature Extraction

### Complete Feature List (41 Features)

#### File Metadata (9)

| #   | Feature       | Type   | Description             |
| --- | ------------- | ------ | ----------------------- |
| 1   | file_size     | int    | File size in bytes      |
| 2   | file_size_log | float  | Log10 of file size      |
| 3   | is_executable | binary | PE/EXE detection        |
| 4   | is_script     | binary | Script file detection   |
| 5   | is_document   | binary | Document file detection |
| 6   | is_archive    | binary | Archive file detection  |
| 7   | is_dll        | binary | DLL detection           |
| 8   | is_exe        | binary | EXE detection           |
| 9   | is_driver     | binary | Driver file detection   |

#### Entropy Analysis (6)

| #   | Feature         | Type   | Description             |
| --- | --------------- | ------ | ----------------------- |
| 10  | overall_entropy | float  | Shannon entropy (0-8)   |
| 11  | header_entropy  | float  | First 256 bytes entropy |
| 12  | middle_entropy  | float  | Middle section entropy  |
| 13  | footer_entropy  | float  | Last 256 bytes entropy  |
| 14  | is_high_entropy | binary | Entropy > 7.0           |
| 15  | is_packed       | binary | Entropy > 7.5           |

#### String Analysis (7)

| #   | Feature         | Type | Description             |
| --- | --------------- | ---- | ----------------------- |
| 16  | total_strings   | int  | Total extracted strings |
| 17  | ascii_strings   | int  | ASCII string count      |
| 18  | unicode_strings | int  | Unicode string count    |
| 19  | url_count       | int  | URL references found    |
| 20  | ip_count        | int  | IP addresses found      |
| 21  | registry_count  | int  | Registry key references |
| 22  | path_count      | int  | File path references    |

#### Pattern Detection (3)

| #   | Feature                 | Type  | Description             |
| --- | ----------------------- | ----- | ----------------------- |
| 23  | avg_string_length       | float | Average string length   |
| 24  | max_string_length       | int   | Maximum string length   |
| 25  | suspicious_string_count | int   | Malicious pattern count |

#### PE Analysis (16)

| #   | Feature                   | Type   | Description               |
| --- | ------------------------- | ------ | ------------------------- |
| 26  | is_pe                     | binary | Valid PE format           |
| 27  | num_sections              | int    | Section count             |
| 28  | num_imports               | int    | Import DLL count          |
| 29  | num_exports               | int    | Exported function count   |
| 30  | suspicious_sections       | int    | Packer section count      |
| 31  | suspicious_imports_high   | int    | High-risk API count       |
| 32  | suspicious_imports_medium | int    | Medium-risk API count     |
| 33  | suspicious_imports_low    | int    | Low-risk API count        |
| 34  | has_signature             | binary | Digital signature present |
| 35  | has_debug_info            | binary | Debug info present        |
| 36  | has_tls                   | binary | TLS callbacks present     |
| 37  | has_resources             | binary | Resources section present |
| 38  | has_relocations           | binary | Relocation table present  |
| 39  | section_entropy_avg       | float  | Average section entropy   |
| 40  | section_entropy_max       | float  | Maximum section entropy   |
| 41  | virtual_size_ratio        | float  | Virtual/Raw size ratio    |

---

## üìã Heuristic Rules

### Rule Details

#### HEUR001: High Entropy Executable

```python
Condition: is_pe AND entropy > 7.0
Severity: HIGH
Score: 30
Rationale: Packed/encrypted executables have high entropy
```

#### HEUR002: Suspicious API Imports

```python
Condition: suspicious_imports_high >= 2
Severity: HIGH
Score: 40
APIs: CreateRemoteThread, WriteProcessMemory, VirtualAllocEx, etc.
```

#### HEUR003: Process Injection Capability

```python
Condition: suspicious_imports_high >= 3
Severity: CRITICAL
Score: 50
Rationale: Multiple injection APIs indicate malicious intent
```

#### HEUR004: Packed Executable

```python
Condition: packer_sections > 0 OR is_packed
Severity: MEDIUM
Score: 25
Sections: .UPX0, .UPX1, .aspack, .nsp0, etc.
```

#### HEUR005: Network Indicators

```python
Condition: url_count > 0 OR ip_count > 0
Severity: LOW
Score: 10
Rationale: Network communication capability
```

#### HEUR006: Registry Modification

```python
Condition: registry_count > 0
Severity: MEDIUM
Score: 20
Patterns: HKEY_LOCAL_MACHINE, CurrentVersion\Run
```

#### HEUR007: Suspicious Strings

```python
Condition: suspicious_string_count >= 3
Severity: HIGH
Score: 35
Strings: ransom, bitcoin, keylog, decrypt, etc.
```

#### HEUR008: No Digital Signature

```python
Condition: is_pe AND NOT has_signature
Severity: LOW
Score: 10
Rationale: Legitimate software is usually signed
```

#### HEUR009: PowerShell Encoded

```python
Condition: Contains "-enc " OR "FromBase64String"
Severity: CRITICAL
Score: 50
Rationale: Obfuscation technique used by malware
```

#### HEUR010: Download Capability

```python
Condition: Contains "DownloadString" OR "URLDownloadToFile"
Severity: HIGH
Score: 30
Rationale: Remote payload download capability
```

---

## ‚ö° Performance

### Benchmarks

| Metric                | Value                       |
| --------------------- | --------------------------- |
| Average Analysis Time | 45ms                        |
| Throughput            | ~20 files/second            |
| Memory Usage          | ~200MB (with models loaded) |
| Model Load Time       | ~2 seconds                  |

### Optimization Tips

1. **Batch Processing:** Use API for multiple files
2. **Caching:** Enable Django caching for repeated files
3. **Model Preloading:** Models load once at startup
4. **File Size Limits:** 50MB max prevents memory issues

---

## üîí Security Considerations

### Best Practices

1. **Sandboxing:** Run in isolated environment
2. **File Validation:** Check file types before analysis
3. **Size Limits:** Enforce maximum file size
4. **Rate Limiting:** Prevent DoS attacks
5. **Logging:** Monitor all file uploads

### Warning

‚ö†Ô∏è **Do not execute analyzed files!** This is a static analysis tool. Malicious files should be handled with extreme caution.

### Recommended Workflow

```
1. User uploads file ‚Üí Analysis runs
2. If malicious ‚Üí Quarantine immediately
3. If suspicious ‚Üí Secondary analysis (VirusTotal)
4. If clean ‚Üí Allow with monitoring
```

---

## üêõ Troubleshooting

### Common Issues

#### Models Not Loading

```
[WARNING] Could not load ML models
```

**Solution:**

```bash
# Check model files exist
ls Services/MalwareAnalysis/models/

# Retrain if missing
cd Services/MalwareAnalysis
jupyter notebook model.ipynb
```

#### pefile Import Error

```
[WARNING] pefile not available - PE analysis will be limited
```

**Solution:**

```bash
pip install pefile
```

#### File Size Error

```
{"error": "File size exceeds 50MB limit"}
```

**Solution:** Split large files or increase limit in `views.py`

#### Template Not Found

```
TemplateDoesNotExist: MalwareAnalysis.html
```

**Solution:** Ensure `Frontend` app is in `INSTALLED_APPS`

---

## ü§ù Contributing

### Development Setup

```bash
# Fork and clone
git clone https://github.com/yourusername/CyberX.git

# Create branch
git checkout -b feature/my-feature

# Make changes and test
python manage.py test

# Submit PR
```

### Adding Detection Rules

```python
# In views.py, add to HeuristicAnalyzer.rules:
{
    'id': 'HEUR011',
    'name': 'My New Rule',
    'severity': 'high',
    'score': 30,
    'check': lambda f: my_condition(f)
}
```

### Adding Signatures

```python
# In views.py, add to SignatureDatabase.KNOWN_MALWARE_HASHES:
"hash_value": "MalwareName"
```

---

## üìÑ License

MIT License - See LICENSE file for details.

---

## üìû Support

- **Issues:** GitHub Issues
- **Email:** support@cyberx.io
- **Documentation:** This README

---

<div align="center">

**Built with ‚ù§Ô∏è for the CyberX Cybersecurity Platform**

![CyberX](https://img.shields.io/badge/CyberX-Malware%20Analysis-red?style=for-the-badge)

</div>
