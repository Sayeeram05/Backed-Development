{% extends 'base.html' %} {% load static %} {% block title %}Malware Analysis -
CyberX Security Platform{% endblock %} {% block extra_css %}
<link rel="stylesheet" href="{% static 'css/services.css' %}" />
<style>
  /* ===== MALWARE ANALYSIS â€” PAGE-SPECIFIC STYLES ===== */

  /* Results Section */
  .results-section {
    max-width: 900px;
    margin: 40px auto;
    padding: 0 20px;
  }

  .result-card {
    background: rgba(26, 26, 46, 0.8);
    backdrop-filter: blur(20px);
    border-radius: 20px;
    overflow: hidden;
    border: 1px solid rgba(0, 255, 136, 0.2);
    box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
  }

  /* Result Header */
  .result-header {
    padding: 30px;
    display: flex;
    align-items: center;
    gap: 25px;
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  }

  .result-header.clean {
    background: linear-gradient(
      135deg,
      rgba(0, 255, 136, 0.15),
      rgba(0, 212, 255, 0.1)
    );
  }
  .result-header.suspicious {
    background: linear-gradient(
      135deg,
      rgba(255, 193, 7, 0.15),
      rgba(255, 152, 0, 0.1)
    );
  }
  .result-header.malicious {
    background: linear-gradient(
      135deg,
      rgba(255, 71, 87, 0.15),
      rgba(220, 53, 69, 0.1)
    );
  }

  .verdict-icon {
    width: 80px;
    height: 80px;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2.5rem;
  }

  .verdict-icon.clean {
    background: rgba(0, 255, 136, 0.2);
    color: var(--primary-color);
  }
  .verdict-icon.suspicious {
    background: rgba(255, 193, 7, 0.2);
    color: #ffc107;
  }
  .verdict-icon.malicious {
    background: rgba(255, 71, 87, 0.2);
    color: var(--accent-red);
  }

  .verdict-info {
    flex: 1;
  }

  .verdict-label {
    font-family: "Orbitron", monospace;
    font-size: 1.8rem;
    font-weight: 700;
    margin-bottom: 5px;
  }

  .verdict-label.clean {
    color: var(--primary-color);
  }
  .verdict-label.suspicious {
    color: #ffc107;
  }
  .verdict-label.malicious {
    color: var(--accent-red);
  }

  .verdict-file {
    color: var(--text-secondary);
    font-size: 0.95rem;
  }

  .verdict-meta {
    text-align: right;
  }

  .threat-score {
    font-family: "Orbitron", monospace;
    font-size: 2.5rem;
    font-weight: 700;
  }

  .threat-score.low {
    color: var(--primary-color);
  }
  .threat-score.medium {
    color: #ffc107;
  }
  .threat-score.high {
    color: var(--accent-red);
  }

  .threat-label {
    color: var(--text-secondary);
    font-size: 0.85rem;
  }

  /* Result Body */
  .result-body {
    padding: 30px;
  }

  /* Metrics Grid */
  .metrics-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 15px;
    margin-bottom: 25px;
  }

  @media (max-width: 768px) {
    .metrics-grid {
      grid-template-columns: repeat(2, 1fr);
    }
  }

  .metric-item {
    background: rgba(15, 15, 35, 0.5);
    padding: 20px;
    border-radius: 12px;
    text-align: center;
    border: 1px solid rgba(255, 255, 255, 0.05);
  }

  .metric-value {
    font-family: "Orbitron", monospace;
    font-size: 1.5rem;
    color: var(--accent-blue);
    font-weight: 700;
    margin-bottom: 5px;
  }

  .metric-label {
    color: var(--text-secondary);
    font-size: 0.85rem;
  }

  /* Detection Methods */
  .detection-section {
    background: rgba(15, 15, 35, 0.5);
    border-radius: 12px;
    padding: 20px;
    margin-bottom: 20px;
    border: 1px solid rgba(255, 255, 255, 0.05);
  }

  .section-title {
    display: flex;
    align-items: center;
    gap: 10px;
    font-family: "Orbitron", monospace;
    color: var(--accent-blue);
    font-size: 1rem;
    margin-bottom: 15px;
  }

  .detection-badges {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
  }

  .detection-badge {
    display: flex;
    align-items: center;
    gap: 8px;
    background: rgba(0, 255, 136, 0.12);
    color: var(--primary-color);
    padding: 8px 15px;
    border-radius: 20px;
    font-size: 0.9rem;
    font-weight: 600;
  }

  .detection-badge i {
    font-size: 0.9rem;
  }

  /* Risk Factors */
  .risk-factors {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .risk-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 15px;
    background: rgba(255, 71, 87, 0.1);
    border-radius: 10px;
    border-left: 3px solid var(--accent-red);
  }

  .risk-item i {
    color: var(--accent-red);
  }

  .risk-item span {
    color: var(--text-secondary);
  }

  /* Recommendations */
  .recommendations {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .recommendation-item {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 15px;
    background: rgba(0, 255, 136, 0.05);
    border-radius: 10px;
  }

  .recommendation-item i {
    color: var(--primary-color);
  }

  .recommendation-item span {
    color: var(--text-secondary);
  }

  /* Accordion */
  .accordion {
    margin-top: 20px;
  }

  .accordion-item {
    background: rgba(15, 15, 35, 0.5);
    border-radius: 12px;
    margin-bottom: 10px;
    overflow: hidden;
    border: 1px solid rgba(255, 255, 255, 0.05);
  }

  .accordion-header {
    padding: 15px 20px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: space-between;
    transition: all 0.3s ease;
  }

  .accordion-header:hover {
    background: rgba(255, 255, 255, 0.02);
  }

  .accordion-title {
    display: flex;
    align-items: center;
    gap: 10px;
    color: var(--text-primary);
    font-weight: 600;
  }

  .accordion-title i {
    color: var(--accent-blue);
  }

  .accordion-icon {
    color: var(--text-secondary);
    transition: transform 0.3s ease;
  }

  .accordion-item.active .accordion-icon {
    transform: rotate(180deg);
  }

  .accordion-content {
    display: none;
    padding: 0 20px 20px;
  }

  .accordion-item.active .accordion-content {
    display: block;
  }

  /* Hash Display */
  .hash-item {
    margin-bottom: 15px;
  }

  .hash-label {
    color: var(--text-secondary);
    font-size: 0.85rem;
    margin-bottom: 5px;
  }

  .hash-value {
    font-family: "Courier New", monospace;
    font-size: 0.85rem;
    background: rgba(0, 0, 0, 0.3);
    padding: 10px 15px;
    border-radius: 8px;
    color: var(--primary-color);
    word-break: break-all;
    user-select: all;
  }

  /* Features Table */
  .features-table {
    width: 100%;
  }

  .features-table tr {
    border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  }

  .features-table tr:last-child {
    border-bottom: none;
  }

  .features-table td {
    padding: 12px 0;
  }

  .features-table td:first-child {
    color: var(--text-secondary);
  }

  .features-table td:last-child {
    text-align: right;
    font-weight: 600;
  }

  .badge {
    display: inline-block;
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 0.8rem;
    font-weight: 600;
  }

  .badge.success {
    background: rgba(0, 255, 136, 0.2);
    color: var(--primary-color);
  }

  .badge.danger {
    background: rgba(255, 71, 87, 0.2);
    color: var(--accent-red);
  }

  .badge.warning {
    background: rgba(255, 193, 7, 0.2);
    color: #ffc107;
  }

  /* Heuristic Rules */
  .heuristic-rules {
    display: flex;
    flex-direction: column;
    gap: 10px;
  }

  .rule-item {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 12px 15px;
    background: rgba(0, 0, 0, 0.2);
    border-radius: 8px;
  }

  .rule-info {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .rule-id {
    font-family: "Courier New", monospace;
    font-size: 0.8rem;
    color: var(--accent-blue);
    background: rgba(0, 212, 255, 0.1);
    padding: 3px 8px;
    border-radius: 5px;
  }

  .rule-name {
    color: var(--text-secondary);
  }

  .severity-badge {
    padding: 4px 10px;
    border-radius: 12px;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
  }

  .severity-badge.critical {
    background: rgba(255, 71, 87, 0.3);
    color: var(--accent-red);
  }

  .severity-badge.high {
    background: rgba(255, 152, 0, 0.3);
    color: #ff9800;
  }

  .severity-badge.medium {
    background: rgba(255, 193, 7, 0.3);
    color: #ffc107;
  }

  .severity-badge.low {
    background: rgba(0, 255, 136, 0.3);
    color: var(--primary-color);
  }

  /* ML Results */
  .ml-results {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 15px;
  }

  .ml-model {
    background: rgba(0, 0, 0, 0.2);
    padding: 20px;
    border-radius: 10px;
    text-align: center;
  }

  .ml-model h5 {
    color: var(--text-secondary);
    font-size: 0.9rem;
    margin-bottom: 10px;
  }

  .ml-confidence {
    font-family: "Orbitron", monospace;
    font-size: 2rem;
    font-weight: 700;
  }

  .ml-confidence.safe {
    color: var(--primary-color);
  }
  .ml-confidence.danger {
    color: var(--accent-red);
  }

  .ml-label {
    font-size: 0.8rem;
    color: var(--text-secondary);
    margin-top: 5px;
  }

  /* Progress Bar */
  .progress-bar {
    height: 8px;
    background: rgba(255, 255, 255, 0.1);
    border-radius: 4px;
    overflow: hidden;
    margin-top: 10px;
  }

  .progress-fill {
    height: 100%;
    border-radius: 4px;
    transition: width 0.5s ease;
  }

  .progress-fill.low {
    background: var(--primary-color);
  }
  .progress-fill.medium {
    background: #ffc107;
  }
  .progress-fill.high {
    background: var(--accent-red);
  }
</style>
{% endblock %} {% block content %}
<div class="container">
  <!-- Hero Section -->
  <section class="service-hero">
    <h1 class="glitch" data-text="MALWARE ANALYSIS">
      <i class="fas fa-shield-virus"></i> MALWARE ANALYSIS
      <span class="version-badge">v2.0</span>
    </h1>
    <p class="hero-subtitle">
      Advanced malware detection combining signature-based, heuristic, and
      machine learning analysis for comprehensive threat identification.
    </p>
    <div class="stats-row">
      <div class="stat-item">
        <span class="stat-number">41</span>
        <span class="stat-label">Features Extracted</span>
      </div>
      <div class="stat-item">
        <span class="stat-number">10</span>
        <span class="stat-label">Heuristic Rules</span>
      </div>
      <div class="stat-item">
        <span class="stat-number">100%</span>
        <span class="stat-label">ML Accuracy</span>
      </div>
    </div>
  </section>

  <!-- Upload Section -->
  <section class="upload-section">
    <div class="service-form-card">
      <div class="form-header">
        <h2><i class="fas fa-upload"></i> Upload File for Analysis</h2>
        <p>Upload any file to scan for malware threats</p>
      </div>

      <form method="post" enctype="multipart/form-data" id="uploadForm">
        {% csrf_token %}

        <div class="file-upload-area" id="dropZone">
          <i class="fas fa-cloud-upload-alt upload-icon"></i>
          <p class="upload-text">Drag & drop file here or click to browse</p>
          <p class="upload-hint">Maximum file size: 50MB</p>
          <input
            type="file"
            name="file"
            id="fileInput"
            class="file-input"
            required
          />
        </div>

        <div class="selected-file" id="selectedFile">
          <i class="fas fa-file file-icon"></i>
          <div class="file-details">
            <div class="file-name" id="fileName"></div>
            <div class="file-size" id="fileSize"></div>
          </div>
          <button type="button" class="remove-file" id="removeFile">
            <i class="fas fa-times"></i>
          </button>
        </div>

        <button type="submit" class="btn-service" id="analyzeBtn" disabled>
          <i class="fas fa-search"></i>
          <span>Analyze File</span>
        </button>
      </form>

      <div class="loading-indicator" id="loadingIndicator">
        <div class="loading-spinner"></div>
        <p class="loading-text">Analyzing file for threats...</p>
      </div>
    </div>

    {% if not result %}
    <!-- Features Grid -->
    <h2 class="section-title" style="margin-top: 40px">
      Analysis Capabilities
    </h2>
    <div class="features-grid">
      <div class="feature-card">
        <div class="feature-icon"><i class="fas fa-fingerprint"></i></div>
        <h4>Signature Analysis</h4>
        <p>Known malware hash database matching</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon"><i class="fas fa-brain"></i></div>
        <h4>Heuristic Rules</h4>
        <p>Behavioral pattern detection engine</p>
      </div>
      <div class="feature-card">
        <div class="feature-icon"><i class="fas fa-robot"></i></div>
        <h4>Machine Learning</h4>
        <p>Ensemble model threat prediction</p>
      </div>
    </div>
    {% endif %}
  </section>

  {% if result %}
  <!-- Results Section -->
  <section class="results-section">
    <div class="result-card">
      <!-- Result Header -->
      <div
        class="result-header {% if result.verdict == 'clean' %}clean{% elif result.verdict == 'suspicious' or result.verdict == 'potentially_unwanted' %}suspicious{% else %}malicious{% endif %}"
      >
        <div
          class="verdict-icon {% if result.verdict == 'clean' %}clean{% elif result.verdict == 'suspicious' or result.verdict == 'potentially_unwanted' %}suspicious{% else %}malicious{% endif %}"
        >
          <i
            class="fas {% if result.verdict == 'clean' %}fa-check-circle{% elif result.verdict == 'suspicious' or result.verdict == 'potentially_unwanted' %}fa-exclamation-triangle{% else %}fa-skull-crossbones{% endif %}"
          ></i>
        </div>
        <div class="verdict-info">
          <div
            class="verdict-label {% if result.verdict == 'clean' %}clean{% elif result.verdict == 'suspicious' or result.verdict == 'potentially_unwanted' %}suspicious{% else %}malicious{% endif %}"
          >
            {{ result.verdict|upper }}
          </div>
          <div class="verdict-file">{{ result.filename }}</div>
        </div>
        <div class="verdict-meta">
          <div
            class="threat-score {% if result.threat_score < 25 %}low{% elif result.threat_score < 60 %}medium{% else %}high{% endif %}"
          >
            {{ result.threat_score }}
          </div>
          <div class="threat-label">Threat Score</div>
        </div>
      </div>

      <!-- Result Body -->
      <div class="result-body">
        <!-- Metrics Grid -->
        <div class="metrics-grid">
          <div class="metric-item">
            <div class="metric-value">
              {{ result.confidence|floatformat:0 }}%
            </div>
            <div class="metric-label">Confidence</div>
          </div>
          <div class="metric-item">
            <div class="metric-value">{{ result.file_size_formatted }}</div>
            <div class="metric-label">File Size</div>
          </div>
          <div class="metric-item">
            <div class="metric-value">
              {{ result.analysis_time|floatformat:0 }}ms
            </div>
            <div class="metric-label">Analysis Time</div>
          </div>
          <div class="metric-item">
            <div class="metric-value">{{ result.features.entropy }}</div>
            <div class="metric-label">Entropy</div>
          </div>
        </div>

        <!-- Threat Score Progress -->
        <div class="detection-section">
          <div class="section-title">
            <i class="fas fa-chart-line"></i>
            <span>Threat Level</span>
          </div>
          <div class="progress-bar">
            <div
              class="progress-fill {% if result.threat_score < 25 %}low{% elif result.threat_score < 60 %}medium{% else %}high{% endif %}"
              style="width: {{ result.threat_score }}%;"
            ></div>
          </div>
        </div>

        <!-- Detection Methods -->
        {% if result.detection_methods %}
        <div class="detection-section">
          <div class="section-title">
            <i class="fas fa-shield-alt"></i>
            <span>Detection Methods</span>
          </div>
          <div class="detection-badges">
            {% for method in result.detection_methods %}
            <div class="detection-badge">
              <i
                class="fas {% if method == 'signature' %}fa-fingerprint{% elif method == 'heuristic' %}fa-brain{% else %}fa-robot{% endif %}"
              ></i>
              <span>{{ method|title }}</span>
            </div>
            {% endfor %}
          </div>
        </div>
        {% endif %}

        <!-- Risk Factors -->
        {% if result.risk_factors %}
        <div class="detection-section">
          <div class="section-title">
            <i class="fas fa-exclamation-triangle"></i>
            <span>Risk Factors</span>
          </div>
          <div class="risk-factors">
            {% for factor in result.risk_factors|slice:":5" %}
            <div class="risk-item">
              <i class="fas fa-times-circle"></i>
              <span>{{ factor }}</span>
            </div>
            {% endfor %}
          </div>
        </div>
        {% endif %}

        <!-- Recommendations -->
        <div class="detection-section">
          <div class="section-title">
            <i class="fas fa-lightbulb"></i>
            <span>Recommendations</span>
          </div>
          <div class="recommendations">
            {% for rec in result.recommendations %}
            <div class="recommendation-item">
              <i class="fas fa-check-circle"></i>
              <span>{{ rec }}</span>
            </div>
            {% endfor %}
          </div>
        </div>

        <!-- Accordion Details -->
        <div class="accordion">
          <!-- File Hashes -->
          <div class="accordion-item">
            <div class="accordion-header" onclick="toggleAccordion(this)">
              <div class="accordion-title">
                <i class="fas fa-fingerprint"></i>
                <span>File Hashes</span>
              </div>
              <i class="fas fa-chevron-down accordion-icon"></i>
            </div>
            <div class="accordion-content">
              <div class="hash-item">
                <div class="hash-label">MD5</div>
                <div class="hash-value">{{ result.signatures.md5 }}</div>
              </div>
              <div class="hash-item">
                <div class="hash-label">SHA-1</div>
                <div class="hash-value">{{ result.signatures.sha1 }}</div>
              </div>
              <div class="hash-item">
                <div class="hash-label">SHA-256</div>
                <div class="hash-value">{{ result.signatures.sha256 }}</div>
              </div>
            </div>
          </div>

          <!-- Extracted Features -->
          <div class="accordion-item">
            <div class="accordion-header" onclick="toggleAccordion(this)">
              <div class="accordion-title">
                <i class="fas fa-chart-bar"></i>
                <span>Extracted Features</span>
              </div>
              <i class="fas fa-chevron-down accordion-icon"></i>
            </div>
            <div class="accordion-content">
              <table class="features-table">
                <tr>
                  <td>File Type</td>
                  <td>{{ result.features.file_type }}</td>
                </tr>
                <tr>
                  <td>Entropy</td>
                  <td>
                    {{ result.features.entropy }} {% if result.features.entropy
                    > 7 %}
                    <span class="badge danger">High</span>
                    {% endif %}
                  </td>
                </tr>
                <tr>
                  <td>Packed</td>
                  <td>
                    {% if result.features.is_packed %}
                    <span class="badge warning">Yes</span>
                    {% else %}
                    <span class="badge success">No</span>
                    {% endif %}
                  </td>
                </tr>
                <tr>
                  <td>Suspicious Strings</td>
                  <td>{{ result.features.suspicious_strings }}</td>
                </tr>
                <tr>
                  <td>Suspicious Imports</td>
                  <td>{{ result.features.suspicious_imports }}</td>
                </tr>
                <tr>
                  <td>URLs Found</td>
                  <td>{{ result.features.url_count }}</td>
                </tr>
                <tr>
                  <td>IP Addresses</td>
                  <td>{{ result.features.ip_count }}</td>
                </tr>
              </table>
            </div>
          </div>

          <!-- Heuristic Analysis -->
          {% if result.heuristic_analysis.triggered_rules %}
          <div class="accordion-item">
            <div class="accordion-header" onclick="toggleAccordion(this)">
              <div class="accordion-title">
                <i class="fas fa-brain"></i>
                <span
                  >Heuristic Analysis (Score: {{
                  result.heuristic_analysis.heuristic_score }})</span
                >
              </div>
              <i class="fas fa-chevron-down accordion-icon"></i>
            </div>
            <div class="accordion-content">
              <div class="heuristic-rules">
                {% for rule in result.heuristic_analysis.triggered_rules %}
                <div class="rule-item">
                  <div class="rule-info">
                    <span class="rule-id">{{ rule.id }}</span>
                    <span class="rule-name">{{ rule.name }}</span>
                  </div>
                  <span class="severity-badge {{ rule.severity }}"
                    >{{ rule.severity }}</span
                  >
                </div>
                {% endfor %}
              </div>
            </div>
          </div>
          {% endif %}

          <!-- ML Analysis -->
          {% if result.ml_analysis %}
          <div class="accordion-item">
            <div class="accordion-header" onclick="toggleAccordion(this)">
              <div class="accordion-title">
                <i class="fas fa-robot"></i>
                <span>Machine Learning Analysis</span>
              </div>
              <i class="fas fa-chevron-down accordion-icon"></i>
            </div>
            <div class="accordion-content">
              <div class="ml-results">
                <div class="ml-model">
                  <h5>Random Forest</h5>
                  <div
                    class="ml-confidence {% if result.ml_analysis.rf_prediction %}danger{% else %}safe{% endif %}"
                  >
                    {{ result.ml_analysis.rf_confidence|floatformat:1 }}%
                  </div>
                  <div class="ml-label">Malicious Confidence</div>
                </div>
                <div class="ml-model">
                  <h5>Gradient Boosting</h5>
                  <div
                    class="ml-confidence {% if result.ml_analysis.gb_prediction %}danger{% else %}safe{% endif %}"
                  >
                    {{ result.ml_analysis.gb_confidence|floatformat:1 }}%
                  </div>
                  <div class="ml-label">Malicious Confidence</div>
                </div>
              </div>
              <div
                style="
                  text-align: center;
                  margin-top: 15px;
                  color: var(--text-secondary);
                "
              >
                <strong>Ensemble:</strong> {{
                result.ml_analysis.ensemble_confidence|floatformat:1 }}%
                malicious probability
              </div>
            </div>
          </div>
          {% endif %}
        </div>
      </div>
    </div>
  </section>
</div>
{% endblock %} {% block extra_js %}
<script>
  // File Upload Handling
  const dropZone = document.getElementById("dropZone");
  const fileInput = document.getElementById("fileInput");
  const selectedFile = document.getElementById("selectedFile");
  const fileName = document.getElementById("fileName");
  const fileSize = document.getElementById("fileSize");
  const removeFile = document.getElementById("removeFile");
  const analyzeBtn = document.getElementById("analyzeBtn");
  const uploadForm = document.getElementById("uploadForm");
  const loadingIndicator = document.getElementById("loadingIndicator");

  // Click to upload
  dropZone.addEventListener("click", () => fileInput.click());

  // Drag and drop
  dropZone.addEventListener("dragover", (e) => {
    e.preventDefault();
    dropZone.classList.add("dragover");
  });

  dropZone.addEventListener("dragleave", () => {
    dropZone.classList.remove("dragover");
  });

  dropZone.addEventListener("drop", (e) => {
    e.preventDefault();
    dropZone.classList.remove("dragover");
    if (e.dataTransfer.files.length) {
      fileInput.files = e.dataTransfer.files;
      handleFileSelect(e.dataTransfer.files[0]);
    }
  });

  // File input change
  fileInput.addEventListener("change", () => {
    if (fileInput.files.length) {
      handleFileSelect(fileInput.files[0]);
    }
  });

  // Handle file selection
  function handleFileSelect(file) {
    fileName.textContent = file.name;
    fileSize.textContent = formatFileSize(file.size);
    selectedFile.classList.add("show");
    dropZone.style.display = "none";
    analyzeBtn.disabled = false;
  }

  // Format file size
  function formatFileSize(bytes) {
    if (bytes === 0) return "0 Bytes";
    const k = 1024;
    const sizes = ["Bytes", "KB", "MB", "GB"];
    const i = Math.floor(Math.log(bytes) / Math.log(k));
    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + " " + sizes[i];
  }

  // Remove file
  removeFile.addEventListener("click", () => {
    fileInput.value = "";
    selectedFile.classList.remove("show");
    dropZone.style.display = "block";
    analyzeBtn.disabled = true;
  });

  // Form submit
  uploadForm.addEventListener("submit", function () {
    analyzeBtn.disabled = true;
    analyzeBtn.innerHTML =
      '<i class="fas fa-spinner fa-spin"></i> <span>Analyzing...</span>';
    loadingIndicator.classList.add("active");
  });

  // Accordion toggle
  function toggleAccordion(header) {
    const item = header.parentElement;
    item.classList.toggle("active");
  }
</script>
{% endblock %}
